<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>无标题文档</title>
		<link href="img/style.css" rel="stylesheet" type="text/css" media="all" />
	</head>
	<body id="original-text">
		<div class="row row1">
			<div class="col col1">
				<div class="wrapper">
					<pre> 

题目：在线问卷调查系统
      
院（系）  计算机科学与技术学院	
专    业      软件工程		   	
届    别  　　2014级	
学    号  　　1425121008			
姓    名  　  邓朴平	
指导老师     喻小光副教授	

               
               
  华侨大学教务处印制
  2018年5月
 
摘要
数据在互联网飞速发展的今天显得尤为重要,通过对数据的处理分析可以发现数据的变化规律,遵循这种变化规律可以预测数据变动走向,以及利用已经采集到的数据通过统计对决策做验证和修正,数据可以渗透到社会生产的各个层面,因此数据在社会生产和个人生活中显得十分重要。数据是需要采集才能够得到的,数据的采集方式也是多种多样,问卷调查是常用的一种采集数据的方式。传统的问卷调查一般都采用直接采访、纸质问卷、电话采访等方式,传统的问卷调查存在调查费用高、操作灵活性低、调查周期较长、调查区域比较局限等问题。为了解决传统问卷调查存在的诸多问题,基于网络的在线问卷调查系统就应运而生。本文主要解决利用网络带来的便利性采用问卷调查的方式采集数据,并将采集到的数据做处理以便分析人员能清晰的看到数据的分布规律以及变化规律。本文研究的在线问卷调查系统包含单选题、多选题、图文题、以及文字回答题,上述几种题型已经满足大部分问卷调查需求。考虑到网络传播的影响力,为了避免不健康以及非法信息利用该问卷系统进行传播,所以本系统有管理员审核问卷的功能用于过滤不健康以及非法信息。本在线问卷调查系统采用asp .net mvc技术框架搭建站点，采用sql server为系统提供数据库服务。













关键词：互联网；问卷调查；数据采集；asp .net；

?
目录
摘要	2
第一章	绪论	5
1.1	在线问卷调查系统的概述	5
1.2	在线问卷调查的国内外发展现状	6
1.3	在线问卷调查的研究意义	6
1.4	论文研究内容和组织框架	7
第二章	需求分析	8
2.1	在线问卷调查系统的需求分析	8
2.1.1	在线问卷调查系统的应用场景	8
2.1.2	在线问卷调查系统主要解决的问题	8
2.1.3	在线问卷调查系统的主要功能	9
2.2	在线问卷调查系统的技术可行性分析	9
第三章	数据库设计	11
3.1	数据库需求分析	11
3.2	数据库E-R图设计	11
3.3	数据库详细设计	12
第四章	系统设计	13
4.1	软件架构设计	13
4.5.1	表现层（USL）	13
4.5.2	业务逻辑层（BLL）	14
4.5.3	数据访问层（DAL）	14
4.5.4	DataBase层	15
4.2	系统用例图设计	15
4.3	系统用例说明	16
4.4	时序图设计	20
4.5	网络拓扑设计	21
第五章	技术要点和难点	22
第六章	系统实现	23
6.1	系统用户界面	23
6.2	系统管理员界面	23
6.3	参与调查者界面	23
第七章	总结展望	24



第一章	绪论
1.1	在线问卷调查系统的概述
问卷调查实际上是一种向社会人群通过访问的形式提出相关问题，获取到被访问者的回答、意见以及感受的一种主动搜集数据的方式。问卷调查是一种通过提问的结构化调查方式，调查的表现形势以及提问的序列还有给出供被调查对象选择的答案都是固定不变的，使用文字表现出来，这使得问卷调查的结果很容易量化，并使得问卷调查的结果更加易于统计和分析。通过问卷调查可以收集到直观有用的数据，对这些数据进行统计可以观察到被调查者想法，态度，行为的分布情况以及预测这些数据变化趋势。对于企业来说，通过问卷调查得到市场需求相关的数据，分析这些数据不仅可以得到当前市场背景下用户的需求分布情况，还可以通过统计规律预测出用户需求变更趋势，以便更好的做出生产调整来迎合市场需求变更，使企业利益最大化。这只是问卷调查在我们生活中最常见的一种应用，在其他行业里问卷调查也有着非常重要的作用。
传统的问卷调查基本都是将问卷设计好过后，将问卷打印到纸张上，然后投放出去进行调查。在这种模式下，每进行一次问卷调查，都将花费不少的费用用于印刷问卷，而且还要投入人力将问卷发放出去。回收问卷的时候不仅会消耗大量的人力，还会存在着问卷回收率低、问卷调查数据统计困难、不能高效而正确地分析、提炼问卷调查结果等问题。如果一次问卷调查不能得到相对准确的统计数据，那么这么次问卷调查将变得毫无意义。由于传统的问卷调查存在诸多问题，所以传统的问卷调查已经不能满人们的工作需求，为了解决这个问题，可以利用当前飞速发展的英特网带来的便捷以及移动设备的普及,设计一个在线的问卷设计、发放、调查、回收、统计的问卷调查系统,以替代传统的问卷调查。在线问卷调查系统可以利用网络在线采集用户需求以及反馈数据，利用采集到的数据可以推断用户的需求倾向以便及时对这种市场变化做出相应对策和准备,还可以根据采集到的数据分析市场需求以及时调整下一步工作计划。相比传统纸质问卷，该问卷调查系统可以节约数据采集的成本，而且使得数据采集的域更广，提高工作效率与质量。
1.2	在线问卷调查的国内外发展现状
随着互联网的飞速发展，低成本、高效率的在线问卷调查系统在国内外的发展也比较迅速。在欧美等互联网比较发达的国家或者地区，在线问卷调查已经被普遍应用于市场调查、民意调查、企业内部调查、网络选举以及学术研究领域。在技术层面，国外的互联网技术发展一直处于世界前沿，据调查在线问卷调查系统在日本和美国的实现技术已经处于世界顶尖水平。在国内，互联网发展起步较晚，传统的问卷调查系统一直是被采用最广泛的一种调查方式，随着近几年国内互联网技术的快速发展，国内也出现了问卷星、问卷网等比较知名的提供在线问卷调查服务的网站。国内许多企业和学校等单位也更多的采用在线问卷调查的方式替代传统的问卷调查来进行各种调查统计。使用一部智能手机或电脑就能参与回答问卷调查，而且提交答案变得更方便，所以被调查者也更乐意在网络上参与问卷调查。
1.3	在线问卷调查的研究意义
在线调查作为一种基于互联网平台上产生的回收信息的"快招"，越来越受到许多评估研究机构和媒介机构的关注、运用。但随着互联网的飞速发展以及全球覆盖、移动智能设备的普及,传统的纸质问卷调查已经不能满足当前背景下的问卷调查需求,而且传统的纸质问卷调查成本较高, 在线问卷调查的答卷回收速度也是非常快的。而纸质问卷的回收率则取决于被访问的读者范围、问卷调查的目的、和问卷发放方法。在线调查答卷在几分钟之内就可以回收，几天内就能完成调查。相反，纸张问卷则需要几周或几个月的时间来进行发送和回收的 [1]。利用互联网的发展和移动设备的普及,在线问卷调查方法较之传统纸质问卷调查更为便捷,成本更低,且环保,调查对象也更广泛,利用计算机程序将采集到的数据进行统计与分析,还能够预测出市场需求变化。因此，研发一个在线问卷调查系统具有重大意义。
1.4	论文研究内容和组织框架
在线问卷调查系统研究的是如何设计并开发出能够利用互联网来发放问卷并且能够自动的统计问卷调查数据的问卷调查系统。当企业或者学校等单位需要发布问卷时，可以利用该系统在线编辑问卷并发放出去用于调查数据，最后通过系统了解到答卷的统计数据来做出相应的应对措施。本文主要解决的问题是：分析在线问卷调查系统的需求，讨论如何设计出能够满足需求的系统架构，然后总和分析确定好采用的技术框架，最后进行编码实现系统功能。
本论文的章节内容设计为：
第二章，介绍在线问卷调查系统的需求分析。通过分析传统问卷调查的存在的诸多问题以及结合实际生活中对问卷调查的使用情况，确定好本次研究的在线问卷调查系统的需求情况，以便进行下一步工作。
第三张，介绍在线问卷调查系统的数据库设计。通过第一章已经得到了需求分析，在此基础之上，对数据库惊醒概念结构设计，然后进行逻辑结构设计得到数据库的E-R图，再将E-R图向关系模型进行转换得到数据库完成数据的设计。
第四章，介绍在线问卷调查系统的软件架构设计，并且对架构中各个层次做详细的说明，然后列出系统的用例图，用例说明，时序图和网络拓扑图等设计。
第五章，技术要点和难点。介绍在从设计到实现该问卷调查系统的过程中所使用的技术要点以及遇到的技术难点。
第六章，系统实现。展示已经经过编码实现的系统效果截图。
第七章，总结展望。通过对本在线问卷调查系统从设计到实现过程中的总结，得出实现该系统自己得到的收获以及表现出来的不足之处，并浅谈对该系统的未来发展的展望。

第二章	需求分析
2.1  	在线问卷调查系统的需求分析
对于一个将要使用该系统发布问卷的用户来说，他能够利用该系统提前编辑问卷，然后提交给管理员审核，在问卷未通过审核之前是不能发布的。当问卷通过审核过后，该用户可以选择立即发布问卷或者将问卷存入草稿箱择期发布。发布问卷过后，该用户就可以将问卷答卷的链接发送给被调查的人群。系统管理员可以登录系统审核用户提交的问卷，如果发现问卷包含不健康信息可以直接退回该问卷，被退回的问卷是不能发布的。当问卷的答卷链接发送出去过后，问卷所属用户可以登录该系统查看问卷的答卷数据，系统将问卷的回答情况用图标形势展示出来，以供使用者直观的观察统计数据。
2.1.1	  在线问卷调查系统的应用场景
需要对某个领域或者特定内容希望利用问卷调查方式采集数据的情景，都可以使用本系统来进行在线问卷调查。本系统对网络依赖性较强，在使用时应该考虑到这一点。
2.1.2	  在线问卷调查系统主要解决的问题
在线问卷调查系统的使用对象有系统用户、系统管理员、参与答卷的用户。针对这三个用户，本系统应该分别为其提供对应的功能服务。
首先是如何成为系统用户。本系统提供注册功能，非系统用户可以通过主页的注册功能成为系统用户。
系统用户可以在本系统内编辑、修改、删除自己的问卷，可以将新编辑好的问卷提交给管理员审核，通过审核的问卷可以选择发布或者存入草稿，对已经发布的问卷，用户可以查看统计数据，这些统计数据将以图表形式展示。
系统管理员可以审核用户提交的问卷，判断问卷内是否包含非法信息，然后根据实际情况选择是否通过审核。
被调查的人群会得到一个问卷的链接网址，利用浏览器打开这个网址就可以看到问卷的主页，并可以在这个页面进行答卷。对于答卷的人群来说，他们都是匿名用户，提交的问卷回答信息是不包含任何他们隐私信息的。
2.1.3	  在线问卷调查系统的主要功能
系统的功能结构图如图2.1.3-1 所示：
 
图 2.1.3-1
2.2  	在线问卷调查系统的技术可行性分析
在2.1章节已经对在线问卷调查系统的需求进行了详细的分析，在本节中要解决的是如何选择技术框架来进行编码实现本系统。
ASP.NET技术以产生和运行动态的、交互的、高性能的WEB服务应用程序为最终目的，他是建立在公共语言运行库（CLR）上的编程框架，可用于在WEB服
务器上生成强大的WEB应用程序。ASP.NET还是基于技术的面向对象对象开发系统，程序员可以使用系统的丰富组件，不仅如此，还可以开发自己的组件，扩展ASP.NET的功能。[2] ASP.NET是一种动态网页技术，加深了WEB的交互，加强了用户体验度，利用ASP.NET 作为本系统的技术开发框架，可以将所学的面向对象理论知识运用于实际开发中，还可以加快开发效率，由于ASP.NET开发的WEB页面将被编译而不是解释，执行一次以后就无需再次编译，这样它们的执行速度就更快，这不仅增加了系统的安全性还加强了系统的可靠性。
在线问卷调查系统是一个典型的WEB应用系统，综合参考决定采用ASP.NET作为本系统的技术开发框架，并采用SQL Server提供数据库服务。
第三章	数据库设计

3.1  	数据库需求分析
通过2.1节已经得到本系统的需求，在对这些需求进行抽象可以得出数据库设计需求如下：
1.一次调可有多个问题,这些问题显示在一个页面；
2.每个问题可以是单选、多选或自定义输入文字；
3.后台可以建立调查，添加、删除、修改问题及答案；
4.调查结束后要求出以下结果：参与者查看自己的答卷、管理员查看每道题各答案的选择数量及比例。
3.2  	数据库E-R图设计
在线问卷调查系统的E-R图如图 3.2.1-1 所示：
 
图 3.2.1-1
3.3  	数据库详细设计
根据E-R图3.2.1-1可以设计出本系统所需的数据库表
(1)	系统用户表（用户ID，登陆账号，登陆密码，昵称） 
(2)	系统管理员（用户ID，登陆账号，登陆密码，昵称）
(3)	问卷表（问卷ID，问卷名称，创建时间，审核时间，开始时间，结束时间，问卷状态，创建者ID）
其中创建者ID字段为参照用户表中用户ID的外键。
(4)	问题表（问题ID，序号，所属问卷ID,问题类型，问题内容）
其中所属问卷ID字段为参照问卷表中问卷ID的外键。
(5)	选择题选项表（选项ID，序号，所属问题ID,选项内容）
其中所属问题ID字段为参照问题表中问题ID的外键。
(6)	答题记录表（答题记录表ID,问卷ID,问题ID,选项ID,文字回答内容，答卷时间）
其中问卷ID,问题ID,选项ID,分别为参照问卷表，问题表，选项表中各主键的外键，选项ID为可空类型。当回答的问卷体型为选择题时，该字段为空。

第四章	系统设计
4.1  	软件架构设计
软件架构是一个系统的草图。软件架构描述的对象是直接构成系统的抽象组件。各个组件之间的连接则明确和相对细致地描述组件之间的通讯。在实现阶段，这些抽象组件被细化为实际的组件，比如具体某个类或者对象。因此一个良好的软件架构设计，可以提高系统的稳定性以及加快系统地开发效率。目前MVC框架（Model View Controller）是基于ASP.NET平台上较为流行的开发框架，采用MVC框架开发本系统能够使代码解耦，便于维护和代码的复用。结合实际情况将本系统划分为DataBase、DAL、BLL、USL这四层。
4.5.1   	表现层（USL）
USL是User Show Layer 的简称，意为表现层，即用与用户进行直接交互的一层。界面层可以通过WEB网页，Android/IOS移动端和WINFORM 桌面客户端等表现形式。本文研究的在线问卷调查系统采用WEB网页的表现形势作为界面层的载体，并选用JavaScript CSS HTML这三个当前较为流行的WEB页面开发语言并采用目前被广泛应用的MVC模式构建系统界面。MVC经典框图如图 4.5.1-1所示：
 
图 4.5.1-1
MVC模式将视图层和业务层分离，这样就允许更改视图层代码而不用重新编译模型和控制器代码，同样，一个应用的业务流程或者业务规则的改变只需要改动MVC的模型层即可。本系统中Controller层处理的只是简单的数据校验以及一些简单的业务逻辑，并不处理系统的核心业务逻辑。这样分层是考虑到问卷系统中，存在大量相同的数据请求情景（如管理员、系统用户、答卷用户都会有浏览问卷这个操作）。构建一个业务逻辑层有利于代码的复用和维护，这样就可以在controller层请求相同的业务逻辑层的数据接口然后再做差异化处理。由于运用MVC的应用程序的三个部件是相互独立，改变其中一个不会影响其它两个，所以依据这种设计思想还能构造良好的松耦合的构件。 
4.5.2   	业务逻辑层（BLL）
BLL 是Business Logic Layer的简称，意为业务逻辑层。业务逻辑层主要的作用是处理系统内部的业务逻辑。业务逻辑层在体系架构中的位置很关键，它处于数据访问层（DAL）与表示层（USL）中间，起到了数据交换中承上启下的作用。由于层是一种弱耦合结构，层与层之间的依赖是向下的，底层对于上层而言是“无知”的，改变上层的设计对于其调用的底层而言没有任何影响。如果在分层设计时，遵循了面向接口设计的思想，那么这种向下的依赖也应该是一种弱依赖关系。因而在不改变接口定义的前提下，理想的分层式架构，应该是一个支持可抽取、可替换的“抽屉”式架构。正因为如此，业务逻辑层的设计对于一个支持可扩展的架构尤为关键，因为它扮演了两个不同的角色。对于数据访问层而言，它是调用者；对于表示层而言，它却是被调用者。BLL层不仅能够降低系统各层次之间的耦合，还对系统的维护和扩展有着重要的作用。
4.5.3   	数据访问层（DAL）
DAL是Data Access Layer的简称，意为数据访问层,其功能主要是负责数据库的访问。简单地说就是实现对数据表的Select（查询）、Insert（插入）、Update（更新）、Delete（删除）等操作。这里放置的是对数据库的CRUD(增删改查)操作，DAL提供了针对不同数据库系统实现的对权限数据库CRUD操作的公共接口和不同实现，如果更换主流关系数据库(比如Oracle)，只需在依赖注入(IOC)中配置另一套接口(Interface)映射即可，无需重新编译代码。数据访问层接收在BLL层经过处理的数据，然后根据相应的业务需求与数据库交互，更新或者查询数据。本层中引入EntityFramwork实体框架以便更为方便的访问数据库。
4.5.4   	DataBase层
DataBase由SQL Server 为本系统提供的数据库服务。 
4.2  	系统用例图设计
本系统用例图如图4.2.1-1所示：
 
图4.2.1-1

4.3  	系统用例说明
用户注册：
用例说明：用户注册
参与者：非系统用户	用例标识号：101
简要说明：非系统用户注册成为系统用户
基本事件流：
1.	进入登录页面，点击注册按钮。

2.	填写邮箱、密码、用户名信息，确认无误后提交注册申请。	



用户登录：
用例说明：用户登录
参与者：系统用户、管理员	用例标识号：201
简要说明：用户登录到本系统中
基本事件流：
1.	进入登录页面，输入登录信息，点击登录按钮。

2.	如登录信息无误，用户则会进入对应的主页，若登录信息验证错误，则会给出相应提示。	
其他事件流：暂无

?

添加问卷：
用例说明：添加问卷
参与者：系统用户	用例标识号：301
简要说明：系统用户添加问卷
基本事件流：
1.	系统用户点击问卷管理菜单，进入问卷列表页面。

2.	点击添加按钮进入问卷添加页面，填写好问卷基本信息点击保存，系统会自动返回到问卷列表页面，并将问卷保存到列表中。

3.	在问卷列表中找到刚添加的问卷，点击问题管理，进入问题列表页面。点击添加问题，填写好问题基本信息，系统会自动返回到问题列表页面，并将问题保存到列表中。
	4.	对于选择类型的问题，则需要点击选项管理，进入选项列表添加待选项。

其他事件流：系统用户登录


编辑问卷：
用例说明：编辑问卷
参与者：系统用户	用例标识号：301
简要说明：系统用户编辑问卷内容
基本事件流：
1.	系统用户点击问卷管理菜单，进入问卷列表页面。

2.	在需要编辑的问卷的操作列中点击编辑问卷按钮，对问卷进行编辑修改。	
其他事件流：编辑问题以及问题的待选项。



提交审核：
用例说明：提交审核
参与者：系统用户	用例标识号：401
简要说明：系统将问卷提交给管理员审核
基本事件流：
1.	系统用户点击问卷管理菜单，进入问卷列表页面。

2.	点击问卷操作列里的提交审核按钮，将问卷提交给管理员审核。
	

其他事件流：暂无



审核问卷：
用例说明：审核问卷
参与者：系统管理员	用例标识号：501
简要说明：系统管理员审核用户提交的待审问卷
基本事件流：
1.	系统管理员问卷管理菜单，进入待审核问卷列表页面。

2.	点击问卷操作列里的浏览问卷按钮，检查问卷内容是否包含非法信息，有则不通过审核，无则通过审核。
	

其他事件流：系统管理员登录


发布问卷：
用例说明：发布问卷
参与者：系统用户	用例标识号：601
简要说明：系统用户发布已经通过审核的问卷。
基本事件流：
1.	系统用户点击问卷管理菜单进入问卷列表页面。

2.	找到已经通过审核且将准备发布的问卷，点击操作列里的发布问卷按钮发布问卷。

3.	发布问卷后得到问卷的答卷链接，将链接发给被答卷人开始问卷调查。
	

其他事件流：系统用户登录

用户答卷：
用例说明：用户参与答卷
参与者：被调查的人群	用例标识号：701
简要说明：被调查的人群参与问卷调查。
基本事件流：
1.	被调查人群得到答卷链接后，利用浏览器打开链接，进入答卷页面。

2.	在答卷页面如实填写问卷信息，完成信息填写后点击提交按钮。
	

其他事件流：问卷发布 


查看答卷数据：
用例说明：查看答卷数据	参与者：系统用户	用例标识号：801
简要说明：系统用户查看发布的问卷的答卷数据。
基本事件流：
1.	系统用户登陆本系统，进入问卷列表页面。

2.	在需要查看答卷信息问卷的操作列点击查看答卷统计按钮查看统计数据。
	

其他事件流：问卷发布 

4.4  	时序图设计
 
4.5  	网络拓扑设计

第五章	技术要点和难点
第六章	系统实现
6.1 	系统用户界面
6.2 	系统管理员界面
6.3 	参与调查者界面
第七章	总结展望
	参考文献
[1]	[期刊论文] 《黑龙江科技信息》 -2011年32期-马英芝 《图书馆在线问卷调查与纸质问卷调查的比较》
[2]	《基于ASPNET的网络问卷调查系统的设计与实现》 李珊




</pre>
				</div>
			</div>
		</div>
	</body>
</html>